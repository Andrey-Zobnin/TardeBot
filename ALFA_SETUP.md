# Настройка интеграции с Альфа-Инвестициями

## Получение API токена

### 1. Регистрация в Альфа-Инвестициях
1. Перейдите на https://invest.alfabank.ru/
2. Зарегистрируйтесь или войдите в существующий аккаунт
3. Откройте брокерский счет (если еще не открыт)

### 2. Получение токена для API
1. В личном кабинете перейдите в раздел "Настройки"
2. Найдите раздел "API для разработчиков"
3. Создайте новый токен с необходимыми правами:
   - Чтение информации о счете
   - Чтение портфеля
   - Получение рыночных данных
   - Размещение ордеров (для реальной торговли)

### 3. Получение ID аккаунта
1. В API документации или через первый запрос к API
2. Или в настройках личного кабинета

## Настройка проекта

### 1. Установка зависимостей
```bash
pip install -r requirements.txt
```

### 2. Настройка конфигурации
Скопируйте `.env.example` в `.env` и заполните:

```env
# Альфа-Инвестиции API
ALFA_TOKEN=your_alfa_invest_token_here
ALFA_ACCOUNT_ID=your_account_id_here

# Включить интеграцию с Альфа-Банком
USE_ALFA_BROKER=true

# Настройки для российского рынка
DEFAULT_SYMBOL=SBER
INITIAL_BALANCE=100000
```

### 3. Тестирование подключения
```bash
python demo_alfa.py
```

## Поддерживаемые функции

### Получение данных
- ✅ Информация о счете
- ✅ Портфель и позиции
- ✅ Текущий баланс
- ✅ Текущие цены акций
- ✅ Исторические данные (свечи)
- ✅ Поиск инструментов

### Торговые операции
- ✅ Размещение рыночных ордеров на покупку
- ✅ Размещение рыночных ордеров на продажу
- ✅ Получение списка ордеров
- ✅ Отмена ордеров
- ✅ История операций

## Популярные российские акции

| Тикер | Название | Описание |
|-------|----------|----------|
| SBER  | Сбербанк | Крупнейший банк России |
| GAZP  | Газпром  | Газовая компания |
| LKOH  | ЛУКОЙЛ   | Нефтяная компания |
| YNDX  | Яндекс   | IT-компания |
| TCSG  | TCS Group| Финтех (Тинькофф) |
| ROSN  | Роснефть | Нефтяная компания |
| NVTK  | НОВАТЭК  | Газовая компания |
| PLZL  | Полюс    | Золотодобыча |

## Безопасность

⚠️ **ВАЖНО**: 
- Никогда не публикуйте токены в открытом доступе
- Используйте токены только с необходимыми правами
- Для тестирования используйте минимальные суммы
- Регулярно обновляйте токены

## Лимиты API

- **Запросы**: обычно 100-300 запросов в минуту
- **Рыночные данные**: могут иметь задержку 15 минут
- **Торговые операции**: в реальном времени

## Режимы работы

### Демонстрационный режим
```env
USE_ALFA_BROKER=false
```
- Использует Yahoo Finance для данных
- Не выполняет реальные сделки
- Безопасно для тестирования

### Реальная торговля
```env
USE_ALFA_BROKER=true
```
- Подключается к Альфа-Инвестициям
- Выполняет реальные сделки
- **Используйте осторожно!**

## Устранение неполадок

### Ошибка аутентификации
- Проверьте правильность токена
- Убедитесь, что токен не истек
- Проверьте права доступа токена

### Ошибка "Инструмент не найден"
- Проверьте правильность тикера
- Используйте российские тикеры (SBER, GAZP, etc.)
- Попробуйте поиск через `demo_alfa.py`

### Ошибка размещения ордера
- Проверьте достаточность средств
- Убедитесь в корректности количества акций
- Проверьте торговые часы (10:00-18:45 МСК)

## Поддержка

- Документация API: https://invest.alfabank.ru/api/
- Техподдержка Альфа-Инвестиций
- GitHub Issues этого проекта