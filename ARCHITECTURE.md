# Архитектура TardeBot

## Обзор системы

TardeBot - это модульный алгоритмический трейдинг-бот, построенный на Python с использованием машинного обучения для предсказания цен акций.

## Основные компоненты

### 1. Модуль данных (`src/data/`)

**StockDataProvider** - отвечает за получение финансовых данных:
- Текущие цены акций через Yahoo Finance API
- Исторические данные для обучения модели
- Предыдущие цены для сравнения
- Кэширование данных для оптимизации

### 2. Модуль машинного обучения (`src/models/`)

**PricePredictor** - предсказание цен с помощью ML:
- Подготовка признаков (технические индикаторы, лаговые переменные)
- Обучение модели Random Forest
- Предсказание будущих цен
- Оценка качества модели (MAE, MSE)

### 3. Торговый модуль (`src/trading/`)

**TradingBot** - основная логика торговли:
- Принятие торговых решений на основе предсказаний
- Управление позициями и балансом
- Логирование всех операций
- Контроль рисков (максимальный размер позиции)

### 4. Утилиты (`src/utils/`)

**Config** - управление конфигурацией:
- Загрузка настроек из переменных окружения
- Значения по умолчанию
- Централизованное управление параметрами

**Logger** - система логирования:
- Настройка уровней логирования
- Ротация файлов логов
- Цветной вывод в консоль

## Поток данных

```
1. StockDataProvider получает данные о акциях
2. PricePredictor обучается на исторических данных
3. PricePredictor делает предсказания на основе текущих данных
4. TradingBot принимает торговые решения
5. TradingBot выполняет операции и логирует результаты
```

## Технические решения

### Машинное обучение
- **Алгоритм**: Random Forest Regressor
- **Признаки**: OHLCV данные, технические индикаторы (SMA, RSI), лаговые переменные
- **Предобработка**: MinMaxScaler для нормализации
- **Валидация**: Train/test split для оценки качества

### Технические индикаторы
- **SMA (Simple Moving Average)**: 5 и 20 периодов
- **RSI (Relative Strength Index)**: 14 периодов
- **Price Change**: Процентное изменение цены
- **Volume Change**: Изменение объема торгов

### Управление рисками
- Максимальный размер позиции (по умолчанию 10% от баланса)
- Минимальный порог для торговли (2% ожидаемого изменения)
- Логирование всех операций для аудита

## Конфигурация

Система использует файл `.env` для настройки:
- API ключи для получения данных
- Торговые параметры (баланс, размер позиции)
- Параметры модели ML
- Настройки логирования

## Расширяемость

Архитектура позволяет легко добавлять:
- Новые источники данных (наследование от базового провайдера)
- Дополнительные ML модели (общий интерфейс предиктора)
- Новые торговые стратегии (модульная структура бота)
- Дополнительные технические индикаторы

## Безопасность

- Конфиденциальные данные в переменных окружения
- Валидация входных данных
- Обработка ошибок и исключений
- Логирование для аудита операций

## Производительность

- Кэширование данных для уменьшения API запросов
- Эффективные алгоритмы ML (Random Forest)
- Асинхронная обработка (возможность расширения)
- Оптимизированная работа с pandas DataFrame

## Тестирование

- Модульные тесты для каждого компонента
- Демонстрационные скрипты для проверки функциональности
- Примеры использования для разных сценариев